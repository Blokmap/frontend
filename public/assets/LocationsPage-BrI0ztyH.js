import{e as T,b as ie,a as se,l as re}from"./primevue-Ex1kWbwE.js";import{e as G,w as K,F as C,_ as S,x as Q,y as W,z as X,v as ne,A as Z,u as le,B as ce,C as pe,D as me}from"./index-BH2d3-5Q.js";import{g as ue}from"./helpers-CQSRa6mq.js";import{L as N,H as ee,j as de,c,d as a,e as n,s as te,k as ve,y as m,h as I,Y as e,t as d,a5 as D,r as R,w as E,o as fe,ad as ge,a0 as he,l as x,T as _e,p as B,D as ke,J as ye,f as oe,a7 as Y,a6 as Le,q as P,F as w,A as z,ae as $e,i as Me}from"./vue-Ch5H8NcK.js";import{O as xe}from"./OpeningsTable-iQ443pCv.js";import{u as Ce}from"./useMapBox-hbhz103P.js";import"@primeuix/styled";import"@primeuix/utils";import"@primeuix/utils/object";import"@primeuix/styles/base";import"@primeuix/utils/dom";import"@primeuix/utils/zindex";import"@primeuix/styles/toast";import"@primeuix/styles/accordion";import"@primeuix/utils/uuid";import"@primeuix/styles/chip";import"@primeuix/styles/autocomplete";import"@primeuix/styles/avatar";import"@primeuix/styles/blockui";import"@primeuix/styles/breadcrumb";import"@primeuix/styles/buttongroup";import"@primeuix/styles/datepicker";import"@primeuix/styles/card";import"@primeuix/styles/carousel";import"@primeuix/styles/cascadeselect";import"@primeuix/styles/checkbox";import"@primeuix/styles/checkboxgroup";import"@primeuix/styles/inputchips";import"@primeuix/styles/colorpicker";import"@primeuix/utils/eventbus";import"@primeuix/styles/dialog";import"@primeuix/styles/confirmdialog";import"@primeuix/styles/confirmpopup";import"@primeuix/styles/contextmenu";import"@primeuix/styles/paginator";import"@primeuix/styles/iconfield";import"@primeuix/styles/inputtext";import"@primeuix/styles/virtualscroller";import"@primeuix/styles/select";import"@primeuix/styles/inputnumber";import"@primeuix/styles/datatable";import"@primeuix/styles/radiobutton";import"@primeuix/styles/dataview";import"@primeuix/styles/divider";import"@primeuix/styles/dock";import"@primeuix/styles/tooltip";import"@primeuix/styles/drawer";import"@primeuix/styles/fieldset";import"@primeuix/styles/badge";import"@primeuix/styles/button";import"@primeuix/styles/message";import"@primeuix/styles/progressbar";import"@primeuix/styles/fileupload";import"@primeuix/styles/floatlabel";import"@primeuix/styles/galleria";import"@primeuix/styles/iftalabel";import"@primeuix/styles/image";import"@primeuix/styles/imagecompare";import"@primeuix/styles/inlinemessage";import"@primeuix/styles/inplace";import"@primeuix/styles/inputgroup";import"@primeuix/styles/inputotp";import"@primeuix/styles/toggleswitch";import"@primeuix/styles/knob";import"@primeuix/styles/listbox";import"@primeuix/styles/megamenu";import"@primeuix/styles/menu";import"@primeuix/styles/menubar";import"@primeuix/styles/metergroup";import"@primeuix/styles/multiselect";import"@primeuix/styles/orderlist";import"@primeuix/styles/organizationchart";import"@primeuix/styles/overlaybadge";import"@primeuix/styles/popover";import"@primeuix/styles/panel";import"@primeuix/styles/panelmenu";import"@primeuix/styles/password";import"@primeuix/styles/picklist";import"@primeuix/styles/progressspinner";import"@primeuix/styles/radiobuttongroup";import"@primeuix/styles/rating";import"@primeuix/styles/scrollpanel";import"@primeuix/styles/scrolltop";import"@primeuix/styles/togglebutton";import"@primeuix/styles/selectbutton";import"@primeuix/styles/skeleton";import"@primeuix/styles/slider";import"@primeuix/styles/speeddial";import"@primeuix/styles/tieredmenu";import"@primeuix/styles/splitbutton";import"@primeuix/styles/splitter";import"@primeuix/styles/stepper";import"@primeuix/styles/steps";import"@primeuix/styles/ripple";import"@primeuix/styles/tabmenu";import"@primeuix/styles/tabs";import"@primeuix/styles/tabview";import"@primeuix/styles/tag";import"@primeuix/styles/terminal";import"@primeuix/styles/textarea";import"@primeuix/styles/timeline";import"@primeuix/styles/toolbar";import"@primeuix/styles/tree";import"@primeuix/styles/treeselect";import"@primeuix/styles/treetable";import"./index-DyskoCvK.js";import"./mapbox-CzQPf59M.js";const be={class:"location"},we=["src"],Pe={class:"location__address"},Te={class:"text-md mt-1 truncate font-semibold"},Be={class:"line-clamp-2 text-xs text-gray-600"},Ne=N({__name:"LocationCard",props:{active:{type:Boolean,default:!1},location:{}},setup(s){const{locale:v}=G(),r=s,g=ee(()=>{var f;return(f=r.location.images)!=null&&f.length?r.location.images[0].url:ue(r.location)});return(f,o)=>{var y;const l=de("tooltip");return a(),c("div",be,[n("div",{class:te(["location__image",{active:s.active}])},[n("img",{src:g.value},null,8,we),ve((a(),c("div",Pe,[m(e(C),{icon:e(K),class:"text-secondary"},null,8,["icon"]),I(" "+d(s.location.city),1)])),[[l,s.location.city]])],2),n("h2",Te,d(s.location.name),1),n("p",Be,d((y=s.location.excerpt)==null?void 0:y[e(v)]),1)])}}}),Fe=S(Ne,[["__scopeId","data-v-f27ed4e3"]]),Ie={class:"flex flex-col gap-2"},De=N({__name:"LocationCardSkeleton",setup(s){return(v,r)=>(a(),c("div",Ie,[m(e(T),{class:"!aspect-square !h-auto w-full"}),m(e(T),{class:"!h-6"}),m(e(T),{class:"!h-9"})]))}}),Ee=N({__name:"Marker",props:{id:{},position:{},active:{type:Boolean},map:{}},emits:["click","mouseenter","mouseleave"],setup(s,{emit:v}){const r=s,g=v,f=D("root"),o=D("popover"),l=R(!1);E(()=>{var i;return(i=r.map)==null?void 0:i.bounds.value},_),fe(()=>{var i;f.value&&(!r.id||!r.position||(window.addEventListener("scroll",_),(i=r.map)==null||i.addMarker({id:r.id,coord:r.position,el:f.value})))}),ge(()=>{var i;l.value&&((i=o==null?void 0:o.value)==null||i.hide(),l.value=!1)}),he(()=>{var i;f.value&&(!r.id||!r.position||(window.removeEventListener("scroll",_),(i=r.map)==null||i.removeMarker(r.id)))});function y(i){var M,u;g("click"),l.value?((M=o==null?void 0:o.value)==null||M.hide(),l.value=!1):((u=o==null?void 0:o.value)==null||u.show(i,f.value),l.value=!0)}function h(){g("mouseenter")}function L(){g("mouseleave")}function _(){var i;!l.value||!o.value||(i=o.value)==null||i.alignOverlay()}return(i,M)=>(a(),x(_e,{to:"body"},[n("div",{ref:"root",onClick:ye(y,["stop"]),onMouseenter:h,onMouseleave:L},[m(ke,{name:"bounce-scale",appear:""},{default:B(()=>[n("div",{class:te(["marker",{active:s.active}])},[m(e(C),{icon:e(K),class:"icon text-slate-50"},null,8,["icon"])],2)]),_:1})],544),m(e(ie),{ref:"popover",class:"min-w-[350px]"},{default:B(()=>[oe(i.$slots,"popover",{},void 0,!0)]),_:3},512)]))}}),Se=S(Ee,[["__scopeId","data-v-76b392d0"]]),Re={ref:"mapContainer",class:"map"},ze={key:0,class:"loader"},Ae={class:"w-full space-y-2 p-1"},Ue={class:"text-lg font-semibold"},je={class:"flex justify-end"},Ve=N({__name:"BlokMap",props:Y({locations:{},isLoading:{type:Boolean}},{hoveredLocation:{default:null},hoveredLocationModifiers:{}}),emits:Y(["click:marker","update:bounds"],["update:hoveredLocation"]),setup(s,{expose:v,emit:r}){const g=Le(s,"hoveredLocation"),f=r,o=ne(),l=Q(W()),y=D("mapContainer"),h=Ce(y,l.config.value);function L(u){f("click:marker",u)}function _(u){g.value=u}function i(){g.value=null}function M(u){o.push({name:"locations.detail",params:{locationId:u}})}return E(h.bounds,u=>{f("update:bounds",u),l.config.value.center=h.center.value,l.config.value.zoom=h.zoom.value,l.config.value.bounds=u},{deep:!0}),v({map:h}),(u,b)=>(a(),c("div",Re,[s.isLoading?(a(),c("div",ze,[b[0]||(b[0]=n("span",null,"Loading",-1)),m(e(C),{icon:e(X),spin:""},null,8,["icon"])])):P("",!0),e(h).isLoaded.value?oe(u.$slots,"default",{key:1},()=>[(a(!0),c(w,null,z(s.locations,t=>{var p;return a(),x(Se,{id:t.id,key:t.id,position:[t.longitude,t.latitude],map:e(h),active:t.id===((p=g.value)==null?void 0:p.id),onClick:k=>L(t.id),onMouseenter:k=>_(t),onMouseleave:i},{popover:B(()=>[n("div",Ae,[n("p",Ue,d(t.name),1),n("p",null,d(t.street)+" "+d(t.number)+" â€¢ "+d(t.zip)+" "+d(t.city),1),m(xe,{class:"my-3","opening-times":t.openingTimes,compact:""},null,8,["opening-times"]),n("div",je,[m(e(se),{onClick:k=>M(t.id),size:"small",text:""},{default:B(()=>[b[1]||(b[1]=I(" Meer Informatie ",-1)),m(e(C),{icon:e(Z),class:"ml-2"},null,8,["icon"])]),_:1},8,["onClick"])])])]),_:2},1032,["id","position","map","active","onClick","onMouseenter"])}),128))],!0):P("",!0)],512))}}),Oe=S(Ve,[["__scopeId","data-v-396045c8"]]);function qe(s){return s.page*s.perPage<s.total}const He={class:"page-container"},Je={class:"locations-list"},Ye={key:0,class:"mt-2"},Ge={key:1,class:"space-y-4"},Ke={class:"flex items-center justify-between text-lg font-semibold"},Qe={key:0},We={key:1},Xe={key:0,class:"text-slate-500"},Ze={class:"text-slate-600"},et={class:"grid grid-cols-2 gap-4 xl:grid-cols-3"},tt={class:"map-container"},ot={class:"sticky top-4 w-full",style:{height:"calc(100vh - 2rem)"}},at=N({name:"LocationsPage",__name:"LocationsPage",setup(s){const v=W(),r=le(),g=G(),{geoLocation:f}=Q(v),{data:o,isPending:l}=ce(v.filters,{enabled:ee(()=>!!v.filters.bounds)}),{mutate:y,isPending:h}=pe({onSuccess:t=>{var k;const p=(k=L.value)==null?void 0:k.map;p==null||p.flyTo([t.longitude,t.latitude])},onError:()=>{r.add({severity:"error",summary:g.t("domains.locations.errors.fetchNearest"),detail:g.t("domains.locations.errors.tryAgainLater")})}}),L=D("map"),_=R(null),i=R(v.filters.perPage??12);E(o,t=>{!t||!t.data.length||(i.value=t.data.length)}),E([f,()=>{var t;return(t=L.value)==null?void 0:t.map.isLoaded}],([t,p])=>{var k;try{p&&t&&((k=L.value)==null||k.map.flyTo([t.coordinates.longitude,t.coordinates.latitude]))}catch(F){console.error("Error flying to geo location:",F)}},{deep:!0,immediate:!0});const M=$e(async t=>{v.updateFilters({bounds:t,page:1})},400);function u(t){window.scrollTo({top:0,behavior:"smooth"}),v.updateFilters({page:t.page+1})}function b(){var p;const t=(p=L.value)==null?void 0:p.map.center.value;t&&y(t)}return(t,p)=>{var F,A,U,j,V,O,q,H,J;const k=Me("RouterLink");return a(),c("div",He,[n("div",Je,[e(l)?(a(),c("div",Ye,[m(e(T),{height:"2rem"}),m(e(T),{class:"mt-3",height:"1rem"})])):(a(),c("div",Ge,[n("h2",Ke,[n("span",null,[(A=(F=e(o))==null?void 0:F.data)!=null&&A.length?(a(),c(w,{key:0},[e(o).truncated?(a(),c("span",Qe,d(t.$t("pages.locations.filters.foundResultsTruncated",[e(o).total])),1)):(a(),c("span",We,d(t.$t("pages.locations.filters.foundResults",[e(o).total])),1))],64)):(a(),c(w,{key:1},[I(d(t.$t("general.noResultsExact")),1)],64))]),m(e(C),{class:"cursor-pointer text-slate-600 hover:text-slate-700",icon:e(me)},null,8,["icon"])]),e(o)&&e(qe)(e(o))?(a(),c("p",Xe,d(t.$t("pages.locations.filters.showingLocations",{perPage:e(o).perPage,total:e(o).total},e(o).perPage)),1)):P("",!0),(j=(U=e(o))==null?void 0:U.data)!=null&&j.length?P("",!0):(a(),c(w,{key:1},[n("p",Ze,d(t.$t("pages.locations.filters.adjustCriteria")),1),n("p",{class:"cursor-pointer text-slate-600 underline",onClick:b},[I(d(t.$t("pages.locations.filters.flyToNearest"))+" ",1),e(h)?(a(),x(e(C),{key:1,icon:e(X),spin:""},null,8,["icon"])):(a(),x(e(C),{key:0,icon:e(Z)},null,8,["icon"]))])],64))])),n("div",et,[e(l)?(a(!0),c(w,{key:0},z(i.value,$=>(a(),x(De,{key:$}))),128)):(O=(V=e(o))==null?void 0:V.data)!=null&&O.length?(a(!0),c(w,{key:1},z(e(o).data,$=>(a(),x(k,{key:$.id,to:{name:"locations.detail",params:{locationId:$.id}},class:"location-card-link"},{default:B(()=>[m(Fe,{location:$,onMouseenter:ae=>_.value=$,onMouseleave:p[0]||(p[0]=ae=>_.value=null)},null,8,["location","onMouseenter"])]),_:2},1032,["to"]))),128)):P("",!0)]),(H=(q=e(o))==null?void 0:q.data)!=null&&H.length?(a(),x(e(re),{key:2,first:e(o).perPage*(e(o).page-1),rows:e(o).perPage,"total-records":e(o).total,onPage:u},null,8,["first","rows","total-records"])):P("",!0)]),n("div",tt,[n("div",ot,[m(Oe,{ref:"map","hovered-location":_.value,"onUpdate:hoveredLocation":p[1]||(p[1]=$=>_.value=$),class:"border-1 border-slate-200",locations:(J=e(o))==null?void 0:J.data,"is-loading":e(l),"onUpdate:bounds":e(M)},null,8,["hovered-location","locations","is-loading","onUpdate:bounds"])])])])}}}),ia=S(at,[["__scopeId","data-v-8fd21fda"]]);export{ia as default};
