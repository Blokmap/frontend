import{g as G,r as I}from"./mapbox-D2Yjif6H.js";import{k as j}from"./index-7bbMbo5P.js";import{r as s,U as M,o as O,Z as S,w as p,a as i}from"./vue-Sv2pE2s2.js";const C={style:"mapbox://styles/mapbox/outdoors-v11",zoom:7,center:[4.4764595,50.5010789],maxBounds:[[2.5889,49.9967],[6.5083,51.6509]],autoGeolocation:!1,geoLocationControl:!0};var U=I();const u=G(U),W="pk.eyJ1IjoiYmxva21hcCIsImEiOiJjbWUwbGZjNjUwMW5qMmxyMmh2NjVrOWZhIn0.ifUTuKDbNnCnV9AqhN-NHg";function P(x,r=C){const{locale:k}=j();r={...C,...r};const l=new Map,t=s(null),w=s(0),m=s(!1),g=s(!1),v=s(!1),L=s(!1),d=M(r.center)?r.center:s(r.center||[0,0]),f=M(r.zoom)?r.zoom:s(r.zoom||1),y=M(r.maxBounds)?r.maxBounds:s(r.maxBounds),h=s([[-180,-90],[180,90]]);O(()=>{if(x.value===null){console.error("Map container is not defined, cannot initialize map");return}const e=new u.Map({accessToken:W,language:k.value,container:x.value,style:r.style,center:d.value,maxBounds:y.value,zoom:f.value});if(e.on("move",async()=>{g.value=!0;const o=e.getBounds(),n=e.getCenter();n&&(d.value=[n.lng,n.lat]),o&&(h.value=[[o.getSouthWest().lng,o.getSouthWest().lat],[o.getNorthEast().lng,o.getNorthEast().lat]])}),e.on("zoom",async()=>{v.value=!0;const o=e.getZoom();o&&(f.value=o)}),e.on("moveend",()=>{g.value=!1}),e.on("zoomend",()=>{v.value=!1}),e.once("load",()=>{m.value=!0}),r.geoLocationControl){const o=new u.GeolocateControl({positionOptions:{enableHighAccuracy:!0}});e.addControl(o),o.on("geolocate",n=>{const{longitude:a,latitude:c}=n.coords;e.flyTo({center:[a,c],zoom:12,duration:1500,essential:!0})}),r.autoGeolocation&&e.once("load",()=>{r.autoGeolocation&&o.trigger()})}t.value=e}),S(()=>{var e;(e=t.value)==null||e.remove()}),p(y,e=>{var n;const o=e??[[-180,-90],[180,90]];(n=t.value)==null||n.setMaxBounds(o)}),p(d,e=>{if(!t.value||!m.value)return;const o=t.value.getCenter(),n=1e-6;(Math.abs(o.lng-e[0])>n||Math.abs(o.lat-e[1])>n)&&t.value.setCenter(e)},{deep:!0}),p(f,e=>{if(!t.value||!m.value)return;const o=t.value.getZoom();Math.abs(o-e)>.01&&t.value.setZoom(e)});function z(e){if(!t.value){console.error("Map is not initialized, cannot add marker");return}const{id:o,coord:n,el:a}=e,c=new u.Marker(a).setLngLat(n).addTo(t.value);l.set(o,c),w.value=l.size}function b(e){var o;(o=l.get(e))==null||o.remove(),l.delete(e),w.value=l.size}function E(e){const o=new Set(e.map(a=>a.id)),n=new Set(l.keys());for(const a of e)l.has(a.id)||z(a);for(const a of n)o.has(a)||b(a)}function Z(e){return new Promise((o,n)=>{if(!t.value){const B=new Error("Map is not initialized, cannot fly to bounds");return console.error(B.message),n(B)}const a=new u.LngLat(e[0][0],e[0][1]),c=new u.LngLat(e[1][0],e[1][1]),T=new u.LngLatBounds(a,c);t.value.once("moveend",()=>o()),t.value.fitBounds(T,{padding:{top:20,bottom:20,left:20,right:20},duration:1e3})})}function N(e){return new Promise((o,n)=>{if(!t.value){const a=new Error("Map is not initialized, cannot fly to location");return console.error(a.message),n(a)}t.value.once("moveend",()=>o()),t.value.flyTo({center:e,zoom:12,duration:1e3,essential:!0})})}return{setMarkers:E,addMarker:z,removeMarker:b,flyToBounds:Z,flyTo:N,center:d,zoom:f,bounds:i(h),isLoaded:i(m),isDragging:i(L),isZooming:i(v),isMoving:i(g)}}export{P as u};
