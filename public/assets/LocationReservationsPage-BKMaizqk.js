import{q as z,h as P,a as V}from"./primevue-Ex1kWbwE.js";import{e as q,ao as F,ap as R,q as E,ah as H,F as b,p as O,t as T,P as Q,_ as U,u as Z,aq as G,ar as M}from"./index-BH2d3-5Q.js";import{R as Y}from"./ReservationStateBadge-DfkWnBIt.js";import{_ as J}from"./ActionMenu.vue_vue_type_script_setup_true_lang-D8x-0TcO.js";import{a as K,T as C}from"./TableCell-DEbrUqoT.js";import{L as $,H as y,c as A,l as D,e as o,p as l,y as s,h as j,Y as a,t as c,q as W,d as S,r as B,Q as X,i as ee}from"./vue-Ch5H8NcK.js";import{u as te,D as oe}from"./useRouteDate-DMrgQeUU.js";import{D as ie}from"./DashboardContent-C7GZlxZW.js";import{b as se,c as ae}from"./useReservations-BsYyUm_C.js";import"@primeuix/styled";import"@primeuix/utils";import"@primeuix/utils/object";import"@primeuix/styles/base";import"@primeuix/utils/dom";import"@primeuix/utils/zindex";import"@primeuix/styles/toast";import"@primeuix/styles/accordion";import"@primeuix/utils/uuid";import"@primeuix/styles/chip";import"@primeuix/styles/autocomplete";import"@primeuix/styles/avatar";import"@primeuix/styles/blockui";import"@primeuix/styles/breadcrumb";import"@primeuix/styles/buttongroup";import"@primeuix/styles/datepicker";import"@primeuix/styles/card";import"@primeuix/styles/carousel";import"@primeuix/styles/cascadeselect";import"@primeuix/styles/checkbox";import"@primeuix/styles/checkboxgroup";import"@primeuix/styles/inputchips";import"@primeuix/styles/colorpicker";import"@primeuix/utils/eventbus";import"@primeuix/styles/dialog";import"@primeuix/styles/confirmdialog";import"@primeuix/styles/confirmpopup";import"@primeuix/styles/contextmenu";import"@primeuix/styles/paginator";import"@primeuix/styles/iconfield";import"@primeuix/styles/inputtext";import"@primeuix/styles/virtualscroller";import"@primeuix/styles/select";import"@primeuix/styles/inputnumber";import"@primeuix/styles/datatable";import"@primeuix/styles/radiobutton";import"@primeuix/styles/dataview";import"@primeuix/styles/divider";import"@primeuix/styles/dock";import"@primeuix/styles/tooltip";import"@primeuix/styles/drawer";import"@primeuix/styles/fieldset";import"@primeuix/styles/badge";import"@primeuix/styles/button";import"@primeuix/styles/message";import"@primeuix/styles/progressbar";import"@primeuix/styles/fileupload";import"@primeuix/styles/floatlabel";import"@primeuix/styles/galleria";import"@primeuix/styles/iftalabel";import"@primeuix/styles/image";import"@primeuix/styles/imagecompare";import"@primeuix/styles/inlinemessage";import"@primeuix/styles/inplace";import"@primeuix/styles/inputgroup";import"@primeuix/styles/inputotp";import"@primeuix/styles/toggleswitch";import"@primeuix/styles/knob";import"@primeuix/styles/listbox";import"@primeuix/styles/megamenu";import"@primeuix/styles/menu";import"@primeuix/styles/menubar";import"@primeuix/styles/metergroup";import"@primeuix/styles/multiselect";import"@primeuix/styles/orderlist";import"@primeuix/styles/organizationchart";import"@primeuix/styles/overlaybadge";import"@primeuix/styles/popover";import"@primeuix/styles/panel";import"@primeuix/styles/panelmenu";import"@primeuix/styles/password";import"@primeuix/styles/picklist";import"@primeuix/styles/progressspinner";import"@primeuix/styles/radiobuttongroup";import"@primeuix/styles/rating";import"@primeuix/styles/scrollpanel";import"@primeuix/styles/scrolltop";import"@primeuix/styles/togglebutton";import"@primeuix/styles/selectbutton";import"@primeuix/styles/skeleton";import"@primeuix/styles/slider";import"@primeuix/styles/speeddial";import"@primeuix/styles/tieredmenu";import"@primeuix/styles/splitbutton";import"@primeuix/styles/splitter";import"@primeuix/styles/stepper";import"@primeuix/styles/steps";import"@primeuix/styles/ripple";import"@primeuix/styles/tabmenu";import"@primeuix/styles/tabs";import"@primeuix/styles/tabview";import"@primeuix/styles/tag";import"@primeuix/styles/terminal";import"@primeuix/styles/textarea";import"@primeuix/styles/timeline";import"@primeuix/styles/toolbar";import"@primeuix/styles/tree";import"@primeuix/styles/treeselect";import"@primeuix/styles/treetable";const re={key:0,class:"rounded-lg border border-slate-200 bg-white px-6 py-12 text-center"},ne={class:"flex items-center justify-between"},le={class:"flex items-center space-x-3"},me={class:"h-10 w-10 flex-shrink-0"},pe={class:"text-sm font-medium text-slate-900"},ue={class:"text-xs text-slate-500"},ce={class:"flex justify-center"},de={class:"flex items-center gap-2 text-sm"},fe={key:0,class:"flex items-center gap-2 text-sm"},ve=$({__name:"LocationReservationsTable",props:{reservations:{},loading:{type:Boolean},isReservationPending:{type:Function}},emits:["change:status"],setup(u,{emit:g}){const x=u,f=g,{locale:h}=q(),w=y(()=>[{label:"Aangemaakt",value:R.Created,icon:F},{label:"Aanwezig",value:R.Present,icon:E},{label:"Afwezig",value:R.Absent,icon:H}]),_=y(()=>{var r;if(!x.reservations)return[];const m=new Map;for(const e of x.reservations){const t=(r=e.createdBy)==null?void 0:r.id;!t||!e.createdBy||(m.has(t)||m.set(t,{profile:e.createdBy,reservations:[]}),m.get(t).reservations.push(e))}return Array.from(m.values()).map(e=>({group:e,items:e.reservations}))}),v=(m,r,e)=>{const t=r.value;t&&(e(),f("change:status",m,t))},d=m=>w.value.find(r=>r.value===m.state)||null;return(m,r)=>_.value.length?(S(),D(K,{key:1,grouped:_.value},{group:l(({data:e,items:t})=>[o("div",ne,[o("div",le,[o("div",me,[s(Q,{profile:e.profile},null,8,["profile"])]),o("div",null,[o("div",pe,c(e.profile.firstName)+" "+c(e.profile.lastName),1),o("div",ue,c(t.length)+" reservatie"+c(t.length!==1?"s":""),1)])])])]),row:l(({data:e})=>[s(C,{column:"Tijd"},{default:l(()=>[s(a(b),{icon:a(O),class:"mr-1"},null,8,["icon"]),j(" "+c(a(T)(e.startTime))+" - "+c(a(T)(e.endTime)),1)]),_:2},1024),s(C,{column:"Aanmaakdatum"},{default:l(()=>[j(c(e.createdAt.toLocaleDateString(a(h),{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})),1)]),_:2},1024),s(C,{column:"Status"},{default:l(()=>[s(Y,{state:e.state},null,8,["state"])]),_:2},1024),s(C,{column:"Acties"},{default:l(()=>{var t;return[o("div",ce,[s(J,{"is-pending":(t=u.isReservationPending)==null?void 0:t.call(u,e.id)},{content:l(({hideMenu:i})=>{var p;return[o("div",null,[r[1]||(r[1]=o("label",{class:"mb-1 block text-sm font-medium text-gray-700"}," Status wijzigen ",-1)),s(a(z),{"model-value":e.state,options:w.value,loading:(p=u.isReservationPending)==null?void 0:p.call(u,e.id),"option-label":"label","option-value":"value",placeholder:"Selecteer nieuwe status",class:"w-full min-w-[200px]",onChange:n=>v(e.id,n,i)},{option:l(({option:n})=>[o("div",de,[s(a(b),{icon:n.icon},null,8,["icon"]),o("span",null,c(n.label),1)])]),value:l(({value:n})=>[n&&d(e)?(S(),A("div",fe,[s(a(b),{icon:d(e).icon},null,8,["icon"]),o("span",null,c(d(e).label),1)])):W("",!0)]),_:2},1032,["model-value","options","loading","onChange"])])]}),_:2},1032,["is-pending"])])]}),_:2},1024)]),_:1},8,["grouped"])):(S(),A("div",re,[...r[0]||(r[0]=[o("p",{class:"text-sm text-slate-500"},"Geen reservaties gevonden voor deze datum.",-1)])]))}}),ge=U(ve,[["__scopeId","data-v-76e082e7"]]),xe={class:"flex flex-wrap items-end gap-3 md:gap-4"},he={class:"min-w-[200px] flex-1"},be={class:"min-w-[250px] flex-1 md:min-w-[300px]"},ye={class:"relative"},_o=$({__name:"LocationReservationsPage",props:{locationId:{}},setup(u){const g=u,x=Z(),f=te(),{data:h,isLoading:w}=se(y(()=>+g.locationId),y(()=>({day:f.value}))),{mutateAsync:_}=ae({onSuccess:()=>{x.add({severity:"success",summary:"Status gewijzigd",detail:"De reservatiesstatus is succesvol gewijzigd."})},onError:t=>{const i=t.message||"Er is iets misgegaan bij het wijzigen van de status.";x.add({severity:"error",summary:"Fout bij wijzigen van reservatiestatus",detail:i})}}),v=B(""),d=B(new Set),m=y(()=>{if(!h.value)return[];if(!v.value.trim())return h.value;const t=v.value.toLowerCase();return h.value.filter(i=>{var k,L;const p=i.createdBy;if(!p)return!1;const n=`${p.firstName} ${p.lastName}`.toLowerCase(),I=((k=p.username)==null?void 0:k.toLowerCase())||"",N=((L=p.email)==null?void 0:L.toLowerCase())||"";return n.includes(t)||I.includes(t)||N.includes(t)})});function r(t){return d.value.has(t)}async function e(t,i){try{d.value.add(t),await _({locationId:+g.locationId,reservationId:t,state:i})}finally{d.value.delete(t)}}return(t,i)=>{const p=ee("RouterLink");return S(),D(ie,null,{default:l(()=>[o("div",xe,[o("div",he,[i[2]||(i[2]=o("label",{class:"mb-2 block text-sm font-medium text-slate-700"},"Datum",-1)),s(oe,{date:a(f),"onUpdate:date":i[0]||(i[0]=n=>X(f)?f.value=n:null)},null,8,["date"])]),o("div",be,[i[3]||(i[3]=o("label",{class:"mb-2 block text-sm font-medium text-slate-700"},"Zoeken",-1)),o("div",ye,[s(a(P),{modelValue:v.value,"onUpdate:modelValue":i[1]||(i[1]=n=>v.value=n),placeholder:"Zoek op naam, gebruikersnaam of e-mail...",class:"w-full pl-10"},null,8,["modelValue"]),s(a(b),{icon:a(G),class:"absolute top-1/2 left-3 -translate-y-1/2 text-slate-400"},null,8,["icon"])])]),s(p,{to:{name:"dashboard.locations.detail.scanner",params:{locationId:g.locationId}}},{default:l(()=>[s(a(V),null,{default:l(()=>[s(a(b),{icon:a(M)},null,8,["icon"]),i[4]||(i[4]=o("span",{class:"hidden sm:inline"},"Open Scanner",-1)),i[5]||(i[5]=o("span",{class:"sm:hidden"},"Scanner",-1))]),_:1})]),_:1},8,["to"])]),s(ge,{reservations:m.value,loading:a(w),"is-reservation-pending":r,"onChange:status":e},null,8,["reservations","loading"])]),_:1})}}});export{_o as default};
