import{g as Z,r as N}from"./mapbox-CzQPf59M.js";import{e as A}from"./index-BH2d3-5Q.js";import{r as s,Q as p,o as O,ah as W,a0 as D,w as h,a as v}from"./vue-Ch5H8NcK.js";const C={style:"mapbox://styles/mapbox/outdoors-v11",zoom:7,maxBounds:[[2.4,49.5],[6.5083,51.6509]],center:[4.4764595,50.5010789],autoGeolocation:!1,geoLocationControl:!0,interactive:!0};var I=N();const c=Z(I),P=void 0;function F(z,n=C){const{locale:b}=A();n={...C,...n};const u=new Map,a=s(null),x=s(0),i=s(!1),f=s(!1),g=s(!1),k=s(!1),d=p(n.center)?n.center:s(n.center||[0,0]),m=p(n.zoom)?n.zoom:s(n.zoom||1),B=p(n.maxBounds)?n.maxBounds:s(n.maxBounds),M=s([[-180,-90],[180,90]]);O(()=>{if(z.value===null){console.error("Map container is not defined, cannot initialize map");return}const e=new c.Map({accessToken:P,language:b.value,container:z.value,style:n.style,center:d.value,maxBounds:B.value,zoom:m.value,interactive:n.interactive});if(e.on("move",async()=>{f.value=!0;const o=e.getBounds(),t=e.getCenter();t&&(d.value=[t.lng,t.lat]),o&&(M.value=[[o.getSouthWest().lng,o.getSouthWest().lat],[o.getNorthEast().lng,o.getNorthEast().lat]])}),e.on("zoom",async()=>{g.value=!0;const o=e.getZoom();o&&(m.value=o)}),e.on("moveend",()=>{f.value=!1}),e.on("zoomend",()=>{g.value=!1}),e.once("load",()=>{i.value=!0;const o=e.getBounds();o&&(M.value=[[o.getSouthWest().lng,o.getSouthWest().lat],[o.getNorthEast().lng,o.getNorthEast().lat]])}),n.geoLocationControl){const o=new c.GeolocateControl({positionOptions:{enableHighAccuracy:!0}});e.addControl(o),o.on("geolocate",t=>{const{longitude:r,latitude:l}=t.coords;e.flyTo({center:[r,l],zoom:17,duration:1500,essential:!0})}),n.autoGeolocation&&e.once("load",()=>{n.autoGeolocation&&o.trigger()})}a.value=e}),W(()=>{var e;if(a.value)try{(e=a.value)==null||e.resize()}catch(o){console.warn("Map resize on activation failed:",o)}}),D(()=>{var e;(e=a.value)==null||e.remove()}),h(B,e=>{var t;const o=e??[[-180,-90],[180,90]];(t=a.value)==null||t.setMaxBounds(o)}),h(d,e=>{if(!a.value||!i.value)return;const o=a.value.getCenter(),t=1e-6;(Math.abs(o.lng-e[0])>t||Math.abs(o.lat-e[1])>t)&&a.value.setCenter(e)},{deep:!0}),h(m,e=>{if(!a.value||!i.value)return;const o=a.value.getZoom();Math.abs(o-e)>.01&&a.value.setZoom(e)});function w(e){if(!a.value){console.error("Map is not initialized, cannot add marker");return}const{id:o,coord:t,el:r}=e,l=new c.Marker(r).setLngLat(t).addTo(a.value);u.set(o,l),x.value=u.size}function y(e){var o;(o=u.get(e))==null||o.remove(),u.delete(e),x.value=u.size}function E(e){const o=new Set(e.map(r=>r.id)),t=new Set(u.keys());for(const r of e)u.has(r.id)||w(r);for(const r of t)o.has(r)||y(r)}function S(e){return new Promise((o,t)=>{if(!a.value){const L=new Error("Map is not initialized, cannot fly to bounds");return console.error(L.message),t(L)}const r=new c.LngLat(e[0][0],e[0][1]),l=new c.LngLat(e[1][0],e[1][1]),G=new c.LngLatBounds(r,l);a.value.once("moveend",()=>o()),a.value.fitBounds(G,{padding:{top:20,bottom:20,left:20,right:20},duration:1e3})})}function T(e,o=16){return new Promise((t,r)=>{if(!a.value){const l=new Error("Map is not initialized, cannot fly to location");return console.error(l.message),r(l)}a.value.once("moveend",()=>t()),a.value.flyTo({center:e,zoom:o,duration:1e3,essential:!0})})}return{setMarkers:E,addMarker:w,removeMarker:y,flyToBounds:S,flyTo:T,center:d,zoom:m,bounds:M,isLoaded:v(i),isDragging:v(k),isZooming:v(g),isMoving:v(f)}}export{C as d,F as u};
