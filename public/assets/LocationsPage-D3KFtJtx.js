import{u as Z,F as S,f as q,_ as K,g as U,a as ee,b as oe,c as te,s as ne,d as ae,e as se,h as le}from"./index-CJPmhKFB.js";import{K as E,i as ie,c as p,b as i,d as f,q as X,j as re,O as e,x as c,f as M,t as b,S as j,r as L,w as A,o as G,k as N,T as ue,I as ce,l as $,M as de,W as ve,a9 as R,L as pe,p as F,F as C,z as D,ab as fe}from"./vue-C1ZH04E9.js";import{f as I,e as me,a as J,l as ge}from"./primevue-Boa-rGZU.js";import{g as he,r as _e}from"./mapbox-D2Yjif6H.js";import{_ as V}from"./GradientText.vue_vue_type_script_setup_true_lang-CiRSbHOt.js";const ke="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Generator:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20width='800px'%20height='800px'%20viewBox='0%200%20120%20120'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='120'%20height='120'%20fill='%23EFF1F3'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M33.2503%2038.4816C33.2603%2037.0472%2034.4199%2035.8864%2035.8543%2035.875H83.1463C84.5848%2035.875%2085.7503%2037.0431%2085.7503%2038.4816V80.5184C85.7403%2081.9528%2084.5807%2083.1136%2083.1463%2083.125H35.8543C34.4158%2083.1236%2033.2503%2081.957%2033.2503%2080.5184V38.4816ZM80.5006%2041.1251H38.5006V77.8751L62.8921%2053.4783C63.9172%2052.4536%2065.5788%2052.4536%2066.6039%2053.4783L80.5006%2067.4013V41.1251ZM43.75%2051.6249C43.75%2054.5244%2046.1005%2056.8749%2049%2056.8749C51.8995%2056.8749%2054.25%2054.5244%2054.25%2051.6249C54.25%2048.7254%2051.8995%2046.3749%2049%2046.3749C46.1005%2046.3749%2043.75%2048.7254%2043.75%2051.6249Z'%20fill='%23687787'/%3e%3c/svg%3e";function ye(k){return ke}const we={class:"location"},Me=["src"],be={class:"address"},xe={class:"text-md mt-1 truncate font-semibold"},Ce={class:"line-clamp-2 text-xs text-gray-600"},Le=E({__name:"LocationCard",props:{active:{type:Boolean,default:!1},location:{}},setup(k){const{locale:u}=Z();return(l,h)=>{var _;const o=ie("tooltip");return i(),p("div",we,[f("div",{class:X(["location--image",{active:l.active}])},[f("img",{src:e(ye)(l.location)},null,8,Me),re((i(),p("div",be,[c(e(S),{icon:e(q),class:"text-secondary"},null,8,["icon"]),M(" "+b(l.location.city),1)])),[[o,l.location.city]])],2),f("h2",xe,b(l.location.name),1),f("p",Ce,b((_=l.location.excerpt)==null?void 0:_[e(u)]),1)])}}}),Be=K(Le,[["__scopeId","data-v-7f433748"]]),$e={class:"flex flex-col gap-2"},Te=E({__name:"LocationCardSkeleton",setup(k){return(u,l)=>(i(),p("div",$e,[c(e(I),{class:"!aspect-square !h-auto w-full"}),c(e(I),{class:"!h-6"}),c(e(I),{class:"!h-9"})]))}}),ze={class:"flex items-center gap-1"},Se={class:"font-bold"},Fe={class:"my-2"},Ie=E({__name:"Marker",props:{location:{},active:{type:Boolean},map:{}},emits:["click","mouseenter","mouseleave"],setup(k,{emit:u}){const l=k,h=u,o=j("popover"),_=j("root"),a=L(!1);A(()=>l.active,s=>{var d,r;s?(a.value=!0,(d=o==null?void 0:o.value)==null||d.show(new Event("mouse"),_.value)):(a.value=!1,(r=o==null?void 0:o.value)==null||r.hide())});function w(s){var d;a.value=!0,(d=o==null?void 0:o.value)==null||d.show(s),h("mouseenter")}function x(){var s;a.value=!1,(s=o.value)==null||s.hide(),h("mouseleave")}function m(){var s;!a.value||!o.value||(s=o.value)==null||s.alignOverlay()}return G(()=>{_.value&&(window.addEventListener("scroll",()=>{a.value&&m()}),l.map.setOnMove(()=>{a.value&&m()}),l.map.addMarker({id:l.location.id,coord:[l.location.longitude,l.location.latitude],el:_.value}),U.fromTo(_.value,{scale:.5,opacity:0},{scale:1,opacity:1,duration:.3,ease:"back.out(1.7)"}))}),(s,d)=>(i(),N(ue,{to:"body"},[f("div",{ref:"root",onClick:d[0]||(d[0]=ce(r=>h("click"),["stop"])),onMouseenter:w,onMouseleave:x},[f("div",{class:X(["marker",{active:s.active}])},[c(e(S),{icon:e(q),class:"icon text-slate-50"},null,8,["icon"])],2)],544),c(e(me),{ref:"popover"},{default:$(()=>[f("div",ze,[c(e(S),{icon:e(ee)},null,8,["icon"]),f("p",Se,b(s.location.name),1)]),f("div",Fe,[f("p",null,b(s.location.street)+" "+b(s.location.number),1),f("p",null,b(s.location.zip)+" "+b(s.location.city),1)])]),_:1},512)]))}}),Ee=K(Ie,[["__scopeId","data-v-59157714"]]),Pe={style:"mapbox://styles/mapbox/outdoors-v11",zoom:7,center:[4.4764595,50.5010789],bounds:[[2.5889,49.9967],[6.5083,51.6509]]};var Oe=_e();const z=he(Oe),Ve="pk.eyJ1IjoiYmxva21hcCIsImEiOiJjbWNjMDBucWgwMDdoMnFxeHRxcmJndmJpIn0.BId0KGL4VrkvsZpgws5Lfg";function je(k,u=Pe){const{locale:l}=Z(),h=new Map,o=L(null),_=L(0),a=L(!1),w=de(()=>o.value!==null&&o.value.isMoving());G(()=>{if(k.value===null)return console.error("Map container is not defined, cannot initialize map");const n=new z.Map({accessToken:Ve,language:l.value,container:k.value,style:u.style,center:u.center,maxBounds:u.bounds,zoom:u.zoom});n.once("load",()=>{a.value=!0}),n.addControl(new z.GeolocateControl({positionOptions:{enableHighAccuracy:!0}})),o.value=n}),ve(()=>{var n;h.forEach(g=>g.remove()),(n=o.value)==null||n.remove(),o.value=null,h.clear()});function x(n){if(!o.value)return console.error("Map is not initialized, cannot add marker");const{id:g,coord:y,el:v}=n,O=new z.Marker(v).setLngLat(y).addTo(o.value);h.set(g,O),_.value=h.size}function m(n){var g;(g=h.get(n))==null||g.remove(),h.delete(n),_.value=h.size}function s(n){const g=new Set(n.map(v=>v.id)),y=new Set(h.keys());for(const v of n)h.has(v.id)||x(v);for(const v of y)g.has(v)||m(v)}function d(n){var g;(g=o.value)==null||g.on("moveend",()=>{var v;const y=(v=o.value)==null?void 0:v.getBounds();y&&n([y.getSouthWest().toArray(),y.getNorthEast().toArray()])})}function r(n){var g;(g=o.value)==null||g.on("move",()=>{var v;const y=(v=o.value)==null?void 0:v.getCenter();y&&n(y.toArray())})}function t(n){if(!o.value)return console.error("Map is not initialized, cannot fly to bounds");const g=new z.LngLat(n[0][0],n[0][1]),y=new z.LngLat(n[1][0],n[1][1]),v=new z.LngLatBounds(g,y);o.value.fitBounds(v,{padding:{top:20,bottom:20,left:20,right:20},duration:1e3})}function B(n){if(!o.value)return console.error("Map is not initialized, cannot fly to location");o.value.flyTo({center:n,zoom:12,duration:1e3,essential:!0})}function P(){if(!o.value)return console.warn("Map is not initialized, cannot get bounds"),null;const n=o.value.getBounds();return n?[[n.getSouthWest().lng,n.getSouthWest().lat],[n.getNorthEast().lng,n.getNorthEast().lat]]:(console.warn("Map bounds are not available"),null)}return{setMarkers:s,addMarker:x,removeMarker:m,setOnBoundsChange:d,setOnMove:r,flyToBounds:t,flyTo:B,getBounds:P,isLoaded:a,isMoving:w}}const Ae={ref:"mapContainer",class:"map"},De={key:0,class:"loader"},Ge=E({__name:"BlokMap",props:R({locations:{},isLoading:{type:Boolean},boundsDebounce:{default:400}},{hoveredLocation:{default:null},hoveredLocationModifiers:{}}),emits:R(["change:bounds","click:marker"],["update:hoveredLocation"]),setup(k,{expose:u,emit:l}){const h=k,o=pe(k,"hoveredLocation"),_=l,a=j("mapContainer"),w=je(a);function x(m){_("click:marker",m)}return G(()=>{const m=L();w.setOnMove(()=>{m.value&&(clearTimeout(m.value),m.value=void 0)}),w.setOnBoundsChange(d=>{m.value=setTimeout(()=>{_("change:bounds",d),m.value=void 0},h.boundsDebounce)});const s=w.getBounds();s&&_("change:bounds",s)}),u({map:w}),(m,s)=>(i(),p("div",Ae,[m.isLoading?(i(),p("div",De,[s[1]||(s[1]=f("span",null,"Loading",-1)),c(e(S),{icon:e(oe),spin:""},null,8,["icon"])])):F("",!0),e(w).isLoaded.value?(i(!0),p(C,{key:1},D(m.locations,d=>{var r;return i(),N(Ee,{key:d.id,map:e(w),location:d,active:d.id===((r=o.value)==null?void 0:r.id),onMouseenter:t=>o.value=d,onMouseleave:s[0]||(s[0]=t=>o.value=null),onClick:t=>x(d.id)},null,8,["map","location","active","onMouseenter","onClick"])}),128)):F("",!0)],512))}});async function Ne(k,u={}){const l=L(null);A(()=>k.value.length,async()=>{!k.value||k.value.length===0||(l.value&&l.value.kill(),l.value=U.fromTo(k.value,{opacity:0,y:u.y??20},{opacity:1,y:0,duration:u.duration??.3,ease:u.ease??"power2.out",stagger:{amount:u.staggerAmount??.5,from:"start"}}))},{immediate:!0})}const We={class:"flex w-full flex-col-reverse items-stretch gap-6 md:flex-row"},He={class:"flex w-full flex-col md:w-4/7"},Re={class:"mb-8"},Je={key:0,class:"mt-2"},Ze={class:"mb-3 flex items-center justify-between text-xl font-semibold"},qe={key:0,class:"text-slate-500"},Ke={class:"grid flex-grow grid-cols-2 gap-x-6 gap-y-8 md:grid-cols-3"},Ue={key:0,class:"mt-8"},Xe={class:"flex md:w-3/7"},Ye={class:"sticky top-4 w-full",style:{height:"calc(100vh - 2rem)"}},ao=E({__name:"LocationsPage",setup(k){const u=te(),{filters:l,flyToTrigger:h}=ne(u),o=j("map"),_=fe();Ne(_);const{data:a,isFetching:w}=ae(l),x=L(null),m=L(u.filters.perPage??12);A(a,r=>{var t;!r||!((t=r.data)!=null&&t.length)||(m.value=r.data.length)}),A([()=>{var r;return(r=o.value)==null?void 0:r.map.isLoaded},()=>l.value.location,h],([r,t])=>{var B;!r||!t||!t.coordinates||(B=o.value)==null||B.map.flyTo([t.coordinates.longitude,t.coordinates.latitude])},{immediate:!0,deep:!0});function s(r){u.updateFilters({bounds:r,page:1})}function d(r){window.scrollTo({top:0,behavior:"smooth"}),u.updateFilters({page:r.page+1})}return(r,t)=>{var B,P,n,g,y,v,O,W,H;return i(),p("div",We,[f("div",He,[f("div",Re,[e(w)?(i(),p("div",Je,[c(e(I),{height:"2rem"}),c(e(I),{class:"mt-3",height:"1rem"})])):(i(),p(C,{key:1},[f("h2",Ze,[f("span",null,[(P=(B=e(a))==null?void 0:B.data)!=null&&P.length?(i(),p(C,{key:0},[e(a).truncated?(i(),p(C,{key:0},[M(" Meer dan "+b(e(a).total)+" ",1),c(V,null,{default:$(()=>t[2]||(t[2]=[M("Blokspots")])),_:1,__:[2]}),t[3]||(t[3]=M(" gevonden "))],64)):(i(),p(C,{key:1},[M(b(e(a).total)+" ",1),c(V,null,{default:$(()=>t[4]||(t[4]=[M("Blokspots")])),_:1,__:[4]}),t[5]||(t[5]=M(" gevonden "))],64))],64)):(i(),p(C,{key:1},[M(" Geen exacte resultaten gevonden ")],64))]),c(e(J),{size:"small",severity:"contrast",onClick:()=>{},outlined:"",rounded:""},{icon:$(()=>[c(e(S),{icon:e(se)},null,8,["icon"])]),_:1})]),(g=(n=e(a))==null?void 0:n.data)!=null&&g.length?(i(),p(C,{key:0},[e(a).total>e(a).perPage?(i(),p("p",qe,[M(b(e(a).perPage)+" van "+b(e(a).total)+" ",1),c(V,null,{default:$(()=>t[6]||(t[6]=[M("Blokspots")])),_:1,__:[6]}),t[7]||(t[7]=M(" getoond. Gebruik de filters om je zoekopdracht te verfijnen. "))])):F("",!0)],64)):(i(),p(C,{key:1},[t[10]||(t[10]=f("p",null,"Probeer je zoekcriteria of filters aan te passen.",-1)),c(e(J),{class:"mt-6",outlined:"",rounded:""},{default:$(()=>[c(e(S),{icon:e(le)},null,8,["icon"]),t[9]||(t[9]=M(" Vlieg naar dichtstbijzijnde ")),c(V,null,{default:$(()=>t[8]||(t[8]=[M("Blokspot")])),_:1,__:[8]})]),_:1,__:[9]})],64))],64))]),f("div",Ke,[e(w)?(i(!0),p(C,{key:0},D(m.value,T=>(i(),N(Te,{key:T}))),128)):(v=(y=e(a))==null?void 0:y.data)!=null&&v.length?(i(!0),p(C,{key:1},D(e(a).data,(T,Y)=>(i(),p("div",{key:Y,ref_for:!0,ref:e(_).set},[c(Be,{location:T,onMouseenter:Q=>x.value=T,onMouseleave:t[0]||(t[0]=Q=>x.value=null)},null,8,["location","onMouseenter"])]))),128)):F("",!0)]),(W=(O=e(a))==null?void 0:O.data)!=null&&W.length?(i(),p("div",Ue,[c(e(ge),{first:e(a).perPage*(e(a).page-1),rows:e(a).perPage,"total-records":e(a).total,onPage:d},null,8,["first","rows","total-records"])])):F("",!0)]),f("div",Xe,[f("div",Ye,[c(Ge,{ref:"map",locations:(H=e(a))==null?void 0:H.data,"is-loading":e(w),"hovered-location":x.value,"onUpdate:hoveredLocation":t[1]||(t[1]=T=>x.value=T),"onChange:bounds":s},null,8,["locations","is-loading","hovered-location"])])])])}}});export{ao as default};
