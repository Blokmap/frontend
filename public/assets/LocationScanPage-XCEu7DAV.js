const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/howler-DS-_xuT0.js","assets/mapbox-CzQPf59M.js"])))=>i.map(i=>d[i]);
import{L as P,a7 as V,a6 as x,ai as D,r as d,H as M,w,a0 as B,l as T,D as L,p as S,c as k,q as R,e as _,k as A,y as g,Y as t,E as O,F as $,A as z,s as I,d as h,o as H,T as N}from"./vue-Ch5H8NcK.js";import{a as E,d as j}from"./primevue-Ex1kWbwE.js";import{F,af as q,Y as U,_ as Y,ay as G,u as J,e as K,v as Q}from"./index-BH2d3-5Q.js";import{a as W}from"./BrowserQRCodeSvgWriter-B_sKuetz.js";import{e as X}from"./useProfile-CIG-owsL.js";import"@primeuix/styled";import"@primeuix/utils";import"@primeuix/utils/object";import"@primeuix/styles/base";import"@primeuix/utils/dom";import"@primeuix/utils/zindex";import"@primeuix/styles/toast";import"@primeuix/styles/accordion";import"@primeuix/utils/uuid";import"@primeuix/styles/chip";import"@primeuix/styles/autocomplete";import"@primeuix/styles/avatar";import"@primeuix/styles/blockui";import"@primeuix/styles/breadcrumb";import"@primeuix/styles/buttongroup";import"@primeuix/styles/datepicker";import"@primeuix/styles/card";import"@primeuix/styles/carousel";import"@primeuix/styles/cascadeselect";import"@primeuix/styles/checkbox";import"@primeuix/styles/checkboxgroup";import"@primeuix/styles/inputchips";import"@primeuix/styles/colorpicker";import"@primeuix/utils/eventbus";import"@primeuix/styles/dialog";import"@primeuix/styles/confirmdialog";import"@primeuix/styles/confirmpopup";import"@primeuix/styles/contextmenu";import"@primeuix/styles/paginator";import"@primeuix/styles/iconfield";import"@primeuix/styles/inputtext";import"@primeuix/styles/virtualscroller";import"@primeuix/styles/select";import"@primeuix/styles/inputnumber";import"@primeuix/styles/datatable";import"@primeuix/styles/radiobutton";import"@primeuix/styles/dataview";import"@primeuix/styles/divider";import"@primeuix/styles/dock";import"@primeuix/styles/tooltip";import"@primeuix/styles/drawer";import"@primeuix/styles/fieldset";import"@primeuix/styles/badge";import"@primeuix/styles/button";import"@primeuix/styles/message";import"@primeuix/styles/progressbar";import"@primeuix/styles/fileupload";import"@primeuix/styles/floatlabel";import"@primeuix/styles/galleria";import"@primeuix/styles/iftalabel";import"@primeuix/styles/image";import"@primeuix/styles/imagecompare";import"@primeuix/styles/inlinemessage";import"@primeuix/styles/inplace";import"@primeuix/styles/inputgroup";import"@primeuix/styles/inputotp";import"@primeuix/styles/toggleswitch";import"@primeuix/styles/knob";import"@primeuix/styles/listbox";import"@primeuix/styles/megamenu";import"@primeuix/styles/menu";import"@primeuix/styles/menubar";import"@primeuix/styles/metergroup";import"@primeuix/styles/multiselect";import"@primeuix/styles/orderlist";import"@primeuix/styles/organizationchart";import"@primeuix/styles/overlaybadge";import"@primeuix/styles/popover";import"@primeuix/styles/panel";import"@primeuix/styles/panelmenu";import"@primeuix/styles/password";import"@primeuix/styles/picklist";import"@primeuix/styles/progressspinner";import"@primeuix/styles/radiobuttongroup";import"@primeuix/styles/rating";import"@primeuix/styles/scrollpanel";import"@primeuix/styles/scrolltop";import"@primeuix/styles/togglebutton";import"@primeuix/styles/selectbutton";import"@primeuix/styles/skeleton";import"@primeuix/styles/slider";import"@primeuix/styles/speeddial";import"@primeuix/styles/tieredmenu";import"@primeuix/styles/splitbutton";import"@primeuix/styles/splitter";import"@primeuix/styles/stepper";import"@primeuix/styles/steps";import"@primeuix/styles/ripple";import"@primeuix/styles/tabmenu";import"@primeuix/styles/tabs";import"@primeuix/styles/tabview";import"@primeuix/styles/tag";import"@primeuix/styles/terminal";import"@primeuix/styles/textarea";import"@primeuix/styles/timeline";import"@primeuix/styles/toolbar";import"@primeuix/styles/tree";import"@primeuix/styles/treeselect";import"@primeuix/styles/treetable";const Z={key:0,class:"overlay"},ee={class:"absolute top-0 z-100 flex w-full justify-between gap-3 p-4"},oe={class:"scanning-region"},te={key:1,class:"loading-message"},ae=P({__name:"ScannerOverlay",props:{visible:{type:Boolean,default:!1},visibleModifiers:{}},emits:V(["scan","close"],["update:visible"]),setup(f,{emit:m}){const l=x(f,"visible"),u=m,{stream:r,enabled:v}=D({constraints:{video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}}}),c=d(),p=d(null),n=d(!1),i=M(()=>v.value&&(!r.value||!n.value));w(l,e=>{var o,s;v.value=e,e||((o=p.value)==null||o.stop(),p.value=null,(s=r.value)==null||s.getTracks().forEach(b=>b.stop()),n.value=!1)},{immediate:!0}),w([r,c],([e,o])=>{!o||!e||p.value||(o.srcObject=e,o.onloadeddata=async()=>{n.value=!0,console.log("Video stream loaded, starting scanner...");try{const s=new W;p.value=await s.decodeFromVideoElement(o,b=>{b&&u("scan",b)})}catch(s){console.error("Scanning failed:",s)}})});function y(){l.value=!1,u("close")}return B(()=>{v.value=!1}),(e,o)=>(h(),T(L,{name:"scale"},{default:S(()=>[l.value?(h(),k("div",Z,[_("div",ee,[g(t(E),{severity:"contrast",size:"small"},{default:S(()=>[g(t(F),{icon:t(q)},null,8,["icon"]),o[0]||(o[0]=_("span",null,"Scaninstellingen",-1))]),_:1}),g(t(E),{onClick:y,severity:"secondary",class:"close-button",rounded:"","aria-label":"Close scanner"},{icon:S(()=>[g(t(F),{icon:t(U)},null,8,["icon"])]),_:1})]),A(_("video",{ref_key:"videoRef",ref:c,autoplay:"",playsinline:"",class:"camera-feed"},null,512),[[O,!i.value]]),_("div",{class:I(["overlay-mask",{loading:i.value}])},[_("div",oe,[i.value?(h(),k("p",te,[g(t(j))])):(h(),k($,{key:0},z(["tl","tr","bl","br"],s=>_("div",{key:s,class:I(`corner corner-${s}`)},null,2)),64))])],2)])):R("",!0)]),_:1}))}}),re=Y(ae,[["__scopeId","data-v-ee32fbeb"]]);function ie(f,{volume:m=1,playbackRate:l=1,soundEnabled:u=!0,interrupt:r=!1,autoplay:v=!1,onload:c,...p}={}){const n=d(null),i=d(!1),y=d(null),e=d(null);function o(a){var C;typeof c=="function"&&c.call(this,a),y.value=(y.value||((C=e.value)==null?void 0:C.duration())||0)*1e3,v===!0&&(i.value=!0)}return H(async()=>{await G(()=>import("./howler-DS-_xuT0.js").then(a=>a.h),__vite__mapDeps([0,1])),n.value=Howl,e.value=new n.value({src:t(f),volume:t(m),rate:t(l),onload:o,...p})}),w(()=>[t(f)],()=>{n.value&&n.value&&e&&e.value&&(e.value=new n.value({src:t(f),volume:t(m),rate:t(l),onload:o,...p}))}),w(()=>[t(m),t(l)],()=>{e.value&&(e.value.volume(t(m)),e.value.rate(t(l)))}),{play:a=>{typeof a>"u"&&(a={}),!(!e.value||!u&&!a.forceSoundEnabled)&&(r&&e.value.stop(),a.playbackRate&&e.value.rate(a.playbackRate),e.value.play(a.id),e.value.once("end",()=>{e.value&&e.value&&!e.value.playing()&&(i.value=!1)}),i.value=!0)},sound:e,isPlaying:i,duration:y,pause:a=>{e.value&&(e.value.pause(typeof a=="number"?a:void 0),i.value=!1)},stop:a=>{e.value&&(e.value.stop(typeof a=="number"?a:void 0),i.value=!1)}}}const se="/assets/ping-C4079ikb.mp3",st=P({__name:"LocationScanPage",props:{locationId:{}},setup(f){const m=f,l=Q(),u=J(),{t:r}=K(),v=ie(se,{volume:3}),c=d([]),{mutateAsync:p,isPending:n}=X({onSuccess:()=>{navigator.vibrate&&navigator.vibrate(500),v.play(),u.add({severity:"success",summary:r("domains.profiles.success.scanSuccessful"),detail:r("domains.profiles.success.scanSuccessfulDetail")})},onError:()=>{u.add({severity:"error",summary:r("domains.profiles.errors.scanFailed"),detail:r("domains.profiles.errors.scanFailedDetail")})}});async function i(e){if(n.value)return;const o=+e.getText(),s=+m.locationId;if(c.value.includes(o)){u.add({id:`already-scanned-${o}`,severity:"info",summary:r("domains.profiles.info.alreadyScanned"),detail:r("domains.profiles.info.alreadyScannedDetail")});return}await p({profileId:o,request:{locationId:s,day:new Date}}),c.value.push(o)}function y(){l.push({name:"dashboard.locations.detail.reservations",params:{locationId:m.locationId}})}return(e,o)=>(h(),T(N,{to:"body"},[g(re,{visible:!0,onScan:i,onClose:y})]))}});export{st as default};
