import{g as se}from"./helpers-f-m2Bt7b.js";import{k as ne,F as w,C as Q,_ as G,D as X,E as ie,G as le,H as re,u as de,I as ue,J as ce,K as pe,L as ve,M as me}from"./index-7bbMbo5P.js";import{M as j,I as V,c as r,b as i,d as s,q as Y,j as fe,i as ge,x as u,f as k,N as e,t as _,S as N,r as D,w as b,o as he,Z as _e,k as R,T as ke,l as I,C as ye,J as Le,e as ee,a3 as W,R as xe,a1 as Me,p as U,F as y,z as A,ad as we,ae as be}from"./vue-Sv2pE2s2.js";import{d as S,b as $e,a as Z,m as Ce}from"./primevue-Dphh8M7u.js";import{u as Pe}from"./useMapBox-CfR87ENN.js";import"./mapbox-D2Yjif6H.js";const Te={class:"location"},Be=["src"],Fe={class:"address"},Se={class:"text-md mt-1 truncate font-semibold"},Ie={class:"line-clamp-2 text-xs text-gray-600"},je=j({__name:"LocationCard",props:{active:{type:Boolean,default:!1},location:{}},setup(g){const{locale:v}=ne(),n=g,h=V(()=>{var d;return(d=n.location.images)!=null&&d.length?n.location.images[0].url:se(n.location)});return(d,c)=>{var f;const o=ge("tooltip");return i(),r("div",Te,[s("div",{class:Y(["location--image",{active:d.active}])},[s("img",{src:h.value},null,8,Be),fe((i(),r("div",Fe,[u(e(w),{icon:e(Q),class:"text-secondary"},null,8,["icon"]),k(" "+_(d.location.city),1)])),[[o,d.location.city]])],2),s("h2",Se,_(d.location.name),1),s("p",Ie,_((f=d.location.excerpt)==null?void 0:f[e(v)]),1)])}}}),ze=G(je,[["__scopeId","data-v-bece0258"]]),Ee={class:"flex flex-col gap-2"},Ne=j({__name:"LocationCardSkeleton",setup(g){return(v,n)=>(i(),r("div",Ee,[u(e(S),{class:"!aspect-square !h-auto w-full"}),u(e(S),{class:"!h-6"}),u(e(S),{class:"!h-9"})]))}}),De=j({__name:"Marker",props:{id:{},position:{},active:{type:Boolean},map:{}},emits:["click","mouseenter","mouseleave"],setup(g,{emit:v}){const n=g,h=v,d=N("root"),c=N("popover"),o=D(!1);b(()=>n.active,a=>{var l,L;a?(o.value=!0,(l=c==null?void 0:c.value)==null||l.show(new Event("mouse"),d.value)):(o.value=!1,(L=c==null?void 0:c.value)==null||L.hide())}),b(()=>{var a;return(a=n.map)==null?void 0:a.bounds.value},x),he(()=>{var a;d.value&&(!n.id||!n.position||(window.addEventListener("scroll",x),(a=n.map)==null||a.addMarker({id:n.id,coord:n.position,el:d.value})))}),_e(()=>{var a;d.value&&(!n.id||!n.position||(window.removeEventListener("scroll",x),(a=n.map)==null||a.removeMarker(n.id)))});function f(a){var l;o.value=!0,(l=c==null?void 0:c.value)==null||l.show(a),h("mouseenter")}function $(){var a;o.value=!1,(a=c.value)==null||a.hide(),h("mouseleave")}function x(){var a;!o.value||!c.value||(a=c.value)==null||a.alignOverlay()}return(a,l)=>(i(),R(ke,{to:"body"},[s("div",{ref:"root",onClick:l[0]||(l[0]=Le(L=>h("click"),["stop"])),onMouseenter:f,onMouseleave:$},[u(ye,{name:"bounce-scale",appear:""},{default:I(()=>[s("div",{class:Y(["marker",{active:a.active}])},[u(e(w),{icon:e(Q),class:"icon text-slate-50"},null,8,["icon"])],2)]),_:1})],544),u(e($e),{ref:"popover"},{default:I(()=>[ee(a.$slots,"popover",{},void 0,!0)]),_:3},512)]))}}),Ue=G(De,[["__scopeId","data-v-35949a81"]]),Ve={ref:"mapContainer",class:"map"},Ae={key:0,class:"loader"},Ge={class:"flex items-center gap-1"},Re={class:"font-bold"},qe={class:"my-2"},He=j({__name:"BlokMap",props:W({locations:{},isLoading:{type:Boolean}},{hoveredLocation:{default:null},hoveredLocationModifiers:{}}),emits:W(["click:marker","update:bounds"],["update:hoveredLocation"]),setup(g,{expose:v,emit:n}){const h=xe(g,"hoveredLocation"),d=n,c=N("mapContainer"),o=Me("map",{}),f=Pe(c,o.value);function $(l){d("click:marker",l)}function x(l){h.value=l}function a(){h.value=null}return b(f.bounds,l=>{d("update:bounds",l),o.value.center=f.center.value,o.value.zoom=f.zoom.value},{deep:!0,immediate:!0}),v({map:f}),(l,L)=>(i(),r("div",Ve,[l.isLoading?(i(),r("div",Ae,[L[0]||(L[0]=s("span",null,"Loading",-1)),u(e(w),{icon:e(X),spin:""},null,8,["icon"])])):U("",!0),e(f).isLoaded.value?ee(l.$slots,"default",{key:1},()=>[(i(!0),r(y,null,A(l.locations,p=>{var C;return i(),R(Ue,{key:p.id,id:p.id,position:[p.longitude,p.latitude],map:e(f),active:p.id===((C=h.value)==null?void 0:C.id),onMouseenter:P=>x(p),onMouseleave:a,onClick:P=>$(p.id)},{popover:I(()=>[s("div",Ge,[u(e(w),{icon:e(ie)},null,8,["icon"]),s("p",Re,_(p.name),1)]),s("div",qe,[s("p",null,_(p.street)+" "+_(p.number),1),s("p",null,_(p.zip)+" "+_(p.city),1)])]),_:2},1032,["id","position","map","active","onMouseenter","onClick"])}),128))],!0):U("",!0)],512))}}),Je=G(He,[["__scopeId","data-v-15d38929"]]);async function Ke(g,v={}){const n=D(null);b(()=>g.value.length,async()=>{!g.value||g.value.length===0||(n.value&&n.value.kill(),n.value=le.fromTo(g.value,{opacity:0,y:v.y??20},{opacity:1,y:0,duration:v.duration??.3,ease:v.ease??"power2.out",stagger:{amount:v.staggerAmount??.5,from:"start"}}))},{immediate:!0})}const Oe={class:"flex w-full flex-col-reverse items-stretch gap-6 md:flex-row"},We={class:"flex w-full flex-col md:w-4/7"},Ze={class:"mb-8"},Qe={key:0,class:"mt-2"},Xe={class:"mb-3 flex items-center justify-between text-xl font-semibold"},Ye={key:0,class:"text-slate-500"},et={key:1,class:"text-slate-500"},tt={class:"grid flex-grow grid-cols-2 gap-x-6 gap-y-8 md:grid-cols-3"},ot={key:0,class:"mt-8"},at={class:"flex md:w-3/7"},st={class:"sticky top-4 w-full",style:{height:"calc(100vh - 2rem)"}},ct=j({__name:"LocationsPage",setup(g){const v=re(),n=de(),{filters:h,geoLocation:d,geoLocationActionTrigger:c}=ue(v),{data:o,isFetching:f,isPending:$}=ce(h,{enabled:V(()=>!!h.value.bounds)}),{mutate:x,isPending:a}=pe({onSuccess:m=>{var t;return(t=l.value)==null?void 0:t.map.flyTo([m.longitude,m.latitude])},onError:()=>{n.add({severity:"error",summary:"Fout bij het ophalen van de dichtstbijzijnde locatie",detail:"Probeer het later opnieuw."})}}),l=N("map"),L=we(),p=D(null),C=D(v.filters.perPage??12),P=V(()=>f.value||$.value);b(o,m=>{!m||!m.data.length||(C.value=m.data.length)}),b([()=>{var m;return(m=l.value)==null?void 0:m.map.isLoaded},d,c],([m,t])=>{var T,B,F;if(!(!m||!t))try{(F=l.value)==null||F.map.flyTo([(T=t.coordinates)==null?void 0:T.longitude,(B=t.coordinates)==null?void 0:B.latitude])}catch(z){console.error("Error flying to geo location:",z)}},{deep:!0,immediate:!0}),Ke(L);const te=be(m=>{v.updateFilters({bounds:m,page:1})},400),oe=m=>{window.scrollTo({top:0,behavior:"smooth"}),v.updateFilters({page:m.page+1})};return(m,t)=>{var T,B,F,z,q,H,J,K,O;return i(),r("div",Oe,[s("div",We,[s("div",Ze,[P.value?(i(),r("div",Qe,[u(e(S),{height:"2rem"}),u(e(S),{class:"mt-3",height:"1rem"})])):(i(),r(y,{key:1},[s("h2",Xe,[s("span",null,[(B=(T=e(o))==null?void 0:T.data)!=null&&B.length?(i(),r(y,{key:0},[e(o).truncated?(i(),r(y,{key:0},[k(" Meer dan "+_(e(o).total)+" ",1),t[3]||(t[3]=s("span",{class:"text-gradient-conic"},"locaties",-1)),t[4]||(t[4]=k(" gevonden "))],64)):(i(),r(y,{key:1},[k(_(e(o).total)+" ",1),t[5]||(t[5]=s("span",{class:"text-gradient-conic"},"locaties",-1)),t[6]||(t[6]=k(" gevonden "))],64))],64)):(i(),r(y,{key:1},[k(" Geen exacte resultaten gevonden ")],64))]),u(e(Z),{size:"small",severity:"contrast",outlined:"",rounded:""},{icon:I(()=>[u(e(w),{icon:e(ve)},null,8,["icon"])]),_:1})]),(z=(F=e(o))==null?void 0:F.data)!=null&&z.length?(i(),r(y,{key:0},[e(o).total>e(o).perPage?(i(),r("p",Ye,[k(_(e(o).perPage)+" van "+_(e(o).total)+" ",1),t[7]||(t[7]=s("span",{class:"text-gradient-conic"},"locaties",-1)),t[8]||(t[8]=k(" getoond. Gebruik de filters om je zoekopdracht te verfijnen. "))])):(i(),r("p",et,t[9]||(t[9]=[k(" Klik op een "),s("span",{class:"text-gradient-conic"},"Blokspot",-1),k(" voor meer informatie of om een plek te reserveren. ")])))],64)):(i(),r(y,{key:1},[t[12]||(t[12]=s("p",null,"Probeer je zoekcriteria of filters aan te passen.",-1)),u(e(Z),{class:"mt-6",onClick:t[0]||(t[0]=M=>{var E;return e(x)((E=l.value)==null?void 0:E.map.center.value)}),loading:e(a),outlined:"",rounded:""},{default:I(()=>[u(e(w),{icon:e(a)?e(X):e(me),spin:e(a)},null,8,["icon","spin"]),t[10]||(t[10]=k(" Vlieg naar dichtstbijzijnde ")),t[11]||(t[11]=s("span",{class:"text-gradient-conic"},"Blokspot",-1))]),_:1,__:[10,11]},8,["loading"])],64))],64))]),s("div",tt,[P.value?(i(!0),r(y,{key:0},A(C.value,M=>(i(),R(Ne,{key:M}))),128)):(H=(q=e(o))==null?void 0:q.data)!=null&&H.length?(i(!0),r(y,{key:1},A(e(o).data,(M,E)=>(i(),r("div",{key:E,ref_for:!0,ref:e(L).set},[u(ze,{location:M,onMouseenter:ae=>p.value=M,onMouseleave:t[1]||(t[1]=ae=>p.value=null)},null,8,["location","onMouseenter"])]))),128)):U("",!0)]),(K=(J=e(o))==null?void 0:J.data)!=null&&K.length?(i(),r("div",ot,[u(e(Ce),{first:e(o).perPage*(e(o).page-1),rows:e(o).perPage,"total-records":e(o).total,onPage:oe},null,8,["first","rows","total-records"])])):U("",!0)]),s("div",at,[s("div",st,[u(Je,{ref:"map",locations:(O=e(o))==null?void 0:O.data,"is-loading":P.value,"onUpdate:bounds":e(te),"hovered-location":p.value,"onUpdate:hoveredLocation":t[2]||(t[2]=M=>p.value=M)},null,8,["locations","is-loading","onUpdate:bounds","hovered-location"])])])])}}});export{ct as default};
