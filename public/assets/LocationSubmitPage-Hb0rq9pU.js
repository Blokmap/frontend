import{g as Z,a as N,n as K}from"./primevue-Ex1kWbwE.js";import{X as T,F as y,Y as W,Z as ee,_ as z,$ as te,a0 as se,A as E,a1 as oe,a2 as R,e as ie,a3 as F,z as q}from"./index-BH2d3-5Q.js";import{L as P,H as _,c as x,e as o,f as B,s as j,d as n,l as f,q as h,Y as e,t as S,a7 as ae,a6 as le,r as w,ag as ne,p as b,y as g,h as D,F as A,A as X,i as re,a2 as ue,C as G,Q,T as Y}from"./vue-Ch5H8NcK.js";import{g as me}from"./helpers-BZBkp5df.js";import{L as pe}from"./LocationImagesBuilder-DKBTDaik.js";import{L as de}from"./LocationInformationBuilder-DObRvQqN.js";import{L as ce}from"./LocationSettingsBuilder-CxTcLruL.js";import{D as ve}from"./helpers-CQSRa6mq.js";import"@primeuix/styled";import"@primeuix/utils";import"@primeuix/utils/object";import"@primeuix/styles/base";import"@primeuix/utils/dom";import"@primeuix/utils/zindex";import"@primeuix/styles/toast";import"@primeuix/styles/accordion";import"@primeuix/utils/uuid";import"@primeuix/styles/chip";import"@primeuix/styles/autocomplete";import"@primeuix/styles/avatar";import"@primeuix/styles/blockui";import"@primeuix/styles/breadcrumb";import"@primeuix/styles/buttongroup";import"@primeuix/styles/datepicker";import"@primeuix/styles/card";import"@primeuix/styles/carousel";import"@primeuix/styles/cascadeselect";import"@primeuix/styles/checkbox";import"@primeuix/styles/checkboxgroup";import"@primeuix/styles/inputchips";import"@primeuix/styles/colorpicker";import"@primeuix/utils/eventbus";import"@primeuix/styles/dialog";import"@primeuix/styles/confirmdialog";import"@primeuix/styles/confirmpopup";import"@primeuix/styles/contextmenu";import"@primeuix/styles/paginator";import"@primeuix/styles/iconfield";import"@primeuix/styles/inputtext";import"@primeuix/styles/virtualscroller";import"@primeuix/styles/select";import"@primeuix/styles/inputnumber";import"@primeuix/styles/datatable";import"@primeuix/styles/radiobutton";import"@primeuix/styles/dataview";import"@primeuix/styles/divider";import"@primeuix/styles/dock";import"@primeuix/styles/tooltip";import"@primeuix/styles/drawer";import"@primeuix/styles/fieldset";import"@primeuix/styles/badge";import"@primeuix/styles/button";import"@primeuix/styles/message";import"@primeuix/styles/progressbar";import"@primeuix/styles/fileupload";import"@primeuix/styles/floatlabel";import"@primeuix/styles/galleria";import"@primeuix/styles/iftalabel";import"@primeuix/styles/image";import"@primeuix/styles/imagecompare";import"@primeuix/styles/inlinemessage";import"@primeuix/styles/inplace";import"@primeuix/styles/inputgroup";import"@primeuix/styles/inputotp";import"@primeuix/styles/toggleswitch";import"@primeuix/styles/knob";import"@primeuix/styles/listbox";import"@primeuix/styles/megamenu";import"@primeuix/styles/menu";import"@primeuix/styles/menubar";import"@primeuix/styles/metergroup";import"@primeuix/styles/multiselect";import"@primeuix/styles/orderlist";import"@primeuix/styles/organizationchart";import"@primeuix/styles/overlaybadge";import"@primeuix/styles/popover";import"@primeuix/styles/panel";import"@primeuix/styles/panelmenu";import"@primeuix/styles/password";import"@primeuix/styles/picklist";import"@primeuix/styles/progressspinner";import"@primeuix/styles/radiobuttongroup";import"@primeuix/styles/rating";import"@primeuix/styles/scrollpanel";import"@primeuix/styles/scrolltop";import"@primeuix/styles/togglebutton";import"@primeuix/styles/selectbutton";import"@primeuix/styles/skeleton";import"@primeuix/styles/slider";import"@primeuix/styles/speeddial";import"@primeuix/styles/tieredmenu";import"@primeuix/styles/splitbutton";import"@primeuix/styles/splitter";import"@primeuix/styles/stepper";import"@primeuix/styles/steps";import"@primeuix/styles/ripple";import"@primeuix/styles/tabmenu";import"@primeuix/styles/tabs";import"@primeuix/styles/tabview";import"@primeuix/styles/tag";import"@primeuix/styles/terminal";import"@primeuix/styles/textarea";import"@primeuix/styles/timeline";import"@primeuix/styles/toolbar";import"@primeuix/styles/tree";import"@primeuix/styles/treeselect";import"@primeuix/styles/treetable";import"./LocationBuilderCard-DRy4lkq-.js";import"./LocationMap-BtvvC7Sr.js";import"./useMapBox-hbhz103P.js";import"./mapbox-CzQPf59M.js";const fe={class:"group/step flex flex-col"},ge={class:"flex items-center gap-3"},be={class:"title"},ye={class:"flex gap-3"},_e={class:"content"},xe=P({__name:"Step",props:{title:{},status:{default:"idle"}},setup(d){const a=d,i=_(()=>a.status==="loading"),l=_(()=>a.status==="completed"),u=_(()=>a.status==="error");return(c,r)=>(n(),x("div",fe,[o("div",ge,[o("div",{class:j(["icon-container",{loading:i.value,completed:l.value,error:u.value}])},[B(c.$slots,"icon",{},()=>[l.value?(n(),f(e(y),{key:0,icon:e(T)},null,8,["icon"])):u.value?(n(),f(e(y),{key:1,icon:e(W)},null,8,["icon"])):i.value?(n(),f(e(y),{key:2,icon:e(ee),spin:""},null,8,["icon"])):h("",!0)],!0)],2),B(c.$slots,"title",{},()=>[o("h2",be,S(d.title),1)],!0)]),o("div",ye,[r[0]||(r[0]=o("div",{class:"separator-container group-last/step:invisible"},[o("div",{class:"separator"})],-1)),o("div",_e,[B(c.$slots,"default",{},void 0,!0)])])]))}}),H=z(xe,[["__scopeId","data-v-f715d2da"]]),Se={},ke={class:"flex flex-col"};function he(d,a){return n(),x("div",ke,[B(d.$slots,"default")])}const we=z(Se,[["render",he]]),$e={class:"space-y-4"},Le={key:0,class:"grid grid-cols-3 gap-3"},Ce=["src"],Ie={key:0,class:"image-overlay"},Ne={key:1,class:"image-overlay image-error"},Oe=P({__name:"LocationSubmissionDialog",props:ae({canSubmit:{type:Boolean},location:{},images:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(d){const a=d,i=le(d,"visible"),{mutateAsync:l}=te(),{mutateAsync:u}=se(),c=w(null),r=w(null),p=w("idle"),v=w("idle"),$=w(new Map),I=_(()=>a.canSubmit&&i.value&&p.value==="idle"),J=_(()=>p.value==="completed"&&v.value!=="loading"&&r.value),C=_(()=>{if(a.images.length===0)return!0;for(const s of $.value.values())if(s!=="completed")return!1;return!0});function k(s){return $.value.get(s.index)}async function O(s){if(r.value){$.value.set(s.index,"loading");try{await u({locationId:r.value,image:s}),$.value.set(s.index,"completed"),C.value&&(v.value="completed",c.value=null)}catch(t){$.value.set(s.index,"error"),R(t)&&t.response&&(c.value=t.response.data.message)}}}async function U(){if(r.value)try{v.value="loading",await Promise.all(a.images.map(s=>O(s))),v.value="completed"}catch(s){v.value="error",R(s)&&s.response&&(c.value=s.response.data.message)}}async function V(){c.value=null,r.value=null,p.value="idle",v.value="idle";try{p.value="loading";const s=await l(a.location);p.value="completed",r.value=s.id}catch(s){p.value="error",R(s)&&s.response&&(c.value=s.response.data.message)}}return ne(async()=>{I.value&&(await V(),await U())}),(s,t)=>{const m=re("RouterLink");return n(),f(e(Z),{visible:i.value,"onUpdate:visible":t[0]||(t[0]=L=>i.value=L),class:"max-w-[650px]",closable:!1,modal:""},{header:b(()=>[...t[1]||(t[1]=[o("h2",{class:"text-xl font-semibold"},"Locatie indienen",-1)])]),footer:b(()=>[J.value?(n(),f(m,{key:0,to:{name:"dashboard.locations.detail.openings",params:{locationId:r.value}}},{default:b(()=>[g(e(N),null,{default:b(()=>[t[5]||(t[5]=D(" Openingstijden toevoegen ",-1)),g(e(y),{icon:e(E)},null,8,["icon"])]),_:1})]),_:1},8,["to"])):h("",!0)]),default:b(()=>[g(we,null,{default:b(()=>[g(H,{title:"Nieuwe bloklocatie aanmaken",status:p.value},{default:b(()=>[...t[2]||(t[2]=[D(" De locatiedetails worden gevalideerd en de locatie wordt aangemaakt. Dit kan een paar seconden duren. ",-1)])]),_:1},8,["status"]),p.value==="completed"?(n(),f(H,{key:0,title:"Afbeeldingen uploaden",status:v.value},{default:b(()=>[o("div",$e,[t[4]||(t[4]=o("p",{class:"text-sm text-slate-600"}," De afbeeldingen worden geüpload. Dit kan een paar seconden duren. ",-1)),d.images.length>0?(n(),x("div",Le,[(n(!0),x(A,null,X(d.images,L=>(n(),x("div",{key:L.index,class:"image-preview"},[o("img",{src:e(me)(L),class:j({loading:k(L)==="loading"})},null,10,Ce),k(L)==="loading"?(n(),x("div",Ie,[...t[3]||(t[3]=[o("div",{class:"spinner"},null,-1)])])):h("",!0),k(L)==="error"?(n(),x("div",Ne,[g(e(N),{onClick:Qe=>O(L),severity:"danger",size:"small",rounded:""},{default:b(()=>[g(e(y),{icon:e(oe)},null,8,["icon"])]),_:1},8,["onClick"])])):h("",!0)]))),128))])):h("",!0)])]),_:1},8,["status"])):h("",!0)]),_:1})]),_:1},8,["visible"])}}}),Ae=z(Oe,[["__scopeId","data-v-b09fa572"]]);function De(d){const a=JSON.stringify(d);let i=0;for(let l=0;l<a.length;l++){const u=a.charCodeAt(l);i=(i<<5)-i+u,i=i&i}return Math.abs(i).toString(36)}function M(d,a,i){if(!(a!=null&&a.length)||!d||typeof d!="object")return d;if(Array.isArray(d))return d.map(u=>M(u,a,i));const l={...d};for(const u of a)u in l&&(i&&typeof l[u]=="string"?l[u]=new Date(l[u]):!i&&l[u]instanceof Date&&(l[u]=l[u].toISOString()));return l}function Je(d,a){const{defaults:i,dateFields:l=[]}=a,u=a.version||De(i),c={read:r=>{if(!r)return JSON.parse(JSON.stringify(i));try{const p=JSON.parse(r);return p.version!==u?JSON.parse(JSON.stringify(i)):M(p.data,l,!0)}catch{return JSON.parse(JSON.stringify(i))}},write:r=>{try{const p=M(r,l,!1);return JSON.stringify({version:u,data:p})}catch{return JSON.stringify({version:u,data:i})}}};return ue(d,JSON.parse(JSON.stringify(i)),{serializer:c,writeDefaults:!0})}const Ue={class:"mx-auto flex w-full max-w-[2048px] flex-col gap-4 md:flex-row md:gap-6"},Ve={class:"sidebar"},Be={class:"text-2xl font-bold"},ze={class:"text-sm text-slate-500"},Re={class:"hidden space-y-3 md:block"},Te={class:"sidebar-progress"},Ee={class:"progressbar"},Me={class:"sidebar-navigation hidden w-full justify-between md:flex"},Pe={class:"w-full md:w-5/7"},je={class:"mobile-bottom-bar"},Fe={class:"progressbar flex-1"},qe={class:"flex items-center gap-2 text-xs text-slate-600"},Ge=P({__name:"LocationSubmitPage",setup(d){const{t:a}=ie(),i=w([]),l=Je("location-form",{defaults:ve}),u=w(!1),c=w("basics"),r=w([]),p=[{id:"basics",label:a("pages.locations.submit.steps.basics.label"),desc:a("pages.locations.submit.steps.basics.desc")},{id:"images",label:a("pages.locations.submit.steps.images.label"),desc:a("pages.locations.submit.steps.images.desc")},{id:"settings",label:a("pages.locations.submit.steps.settings.label"),desc:a("pages.locations.submit.steps.settings.desc")}],v=_(()=>p.findIndex(s=>s.id===c.value)),$=_(()=>Math.round((v.value+1)*100/p.length)),I=_(()=>r.value.every(s=>s.isCompleted)),J=_(()=>v.value>0),C=_(()=>c.value==="settings"),k=_(()=>u.value);function O(){if(I.value&&v.value<p.length-1){const s=p[v.value+1].id;c.value=s}}function U(){if(v.value>0){const s=p[v.value-1].id;c.value=s}}async function V(){u.value=!0}return(s,t)=>(n(),x(A,null,[o("div",Ue,[o("div",Ve,[o("h1",Be,S(p[v.value].label),1),o("p",ze,S(p[v.value].desc),1),o("div",Re,[(n(!0),x(A,null,X(r.value,m=>(n(),x("div",{key:m.label},[g(e(K),{"model-value":m.isCompleted,disabled:!0,binary:!0},null,8,["model-value"]),o("span",{class:j(["ms-3 text-sm",m.isCompleted?"text-gray-900":"text-gray-500"])},S(m.label),3)]))),128))]),o("div",Te,[o("div",Ee,[o("div",{class:"indicator",style:G({width:$.value+"%"})},null,4)])]),o("div",Me,[g(e(N),{disabled:!J.value,severity:"secondary",size:"small",onClick:U},{default:b(()=>[g(e(y),{icon:e(F),class:"mr-2"},null,8,["icon"]),D(" "+S(s.$t("general.actions.previous")),1)]),_:1},8,["disabled"]),g(e(N),{disabled:!I.value||k.value,size:"small",onClick:t[0]||(t[0]=m=>C.value?V():O())},{default:b(()=>[C.value?(n(),x(A,{key:0},[k.value?(n(),f(e(y),{key:1,icon:e(q),class:"mr-2",spin:""},null,8,["icon"])):(n(),f(e(y),{key:0,icon:e(T),class:"mr-2"},null,8,["icon"])),D(" "+S(s.$t("general.actions.complete")),1)],64)):(n(),x(A,{key:1},[D(S(s.$t("general.actions.next"))+" ",1),g(e(y),{icon:e(E),class:"ml-2"},null,8,["icon"])],64))]),_:1},8,["disabled"])])]),o("div",Pe,[c.value==="basics"?(n(),f(de,{key:0,modelValue:e(l),"onUpdate:modelValue":t[1]||(t[1]=m=>Q(l)?l.value=m:null),substeps:r.value,"onUpdate:substeps":t[2]||(t[2]=m=>r.value=m)},null,8,["modelValue","substeps"])):h("",!0),c.value==="images"?(n(),f(pe,{key:1,modelValue:i.value,"onUpdate:modelValue":t[3]||(t[3]=m=>i.value=m),substeps:r.value,"onUpdate:substeps":t[4]||(t[4]=m=>r.value=m)},null,8,["modelValue","substeps"])):h("",!0),c.value==="settings"?(n(),f(ce,{key:2,form:e(l),"onUpdate:form":t[5]||(t[5]=m=>Q(l)?l.value=m:null),substeps:r.value,"onUpdate:substeps":t[6]||(t[6]=m=>r.value=m)},null,8,["form","substeps"])):h("",!0)])]),(n(),f(Y,{to:"body"},[g(Ae,{visible:u.value,"onUpdate:visible":t[7]||(t[7]=m=>u.value=m),"can-submit":C.value&&I.value,location:e(l),images:i.value},null,8,["visible","can-submit","location","images"])])),(n(),f(Y,{to:"body"},[o("div",je,[o("div",Fe,[o("div",{class:"indicator",style:G({width:$.value+"%"})},null,4)]),o("div",qe,[o("span",null,S(v.value+1)+"/"+S(p.length),1),t[9]||(t[9]=o("span",{class:"text-slate-400"},"•",-1)),o("span",null,S(r.value.filter(m=>m.isCompleted).length)+"/"+S(r.value.length),1)]),g(e(N),{disabled:!J.value,severity:"secondary",rounded:"",size:"small",onClick:U},{default:b(()=>[g(e(y),{icon:e(F)},null,8,["icon"])]),_:1},8,["disabled"]),g(e(N),{disabled:!I.value||k.value,rounded:"",size:"small",onClick:t[8]||(t[8]=m=>C.value?V():O())},{default:b(()=>[C.value&&!k.value?(n(),f(e(y),{key:0,icon:e(T)},null,8,["icon"])):k.value?(n(),f(e(y),{key:1,icon:e(q),spin:""},null,8,["icon"])):(n(),f(e(y),{key:2,icon:e(E)},null,8,["icon"]))]),_:1},8,["disabled"])])]))],64))}}),Zs=z(Ge,[["__scopeId","data-v-def8d7cb"]]);export{Zs as default};
